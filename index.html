<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-i18n="app.title">Healthy Homes Practitioner App</title>
  <link rel="stylesheet" href="style.css" />

  <!-- jsPDF for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- Leaflet map CSS + JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
  <main>
    <h1 data-i18n="app.title">Healthy Homes Practitioner App</h1>
    <p data-i18n="app.intro">This tool helps field workers assess housing-related health risks and social needs.</p>

    <!-- Language Toggle -->
    <label for="langSelect" data-i18n="language.label">Language:</label>
    <select id="langSelect">
      <option value="en">English</option>
      <option value="zh">中文</option>
    </select>

    <section>
      <h2>🏠 <span data-i18n="app.title">Home Inspection Checklist</span></h2>
      <form id="inspectionForm">
        <label><input type="checkbox" name="mold" /> <span data-i18n="checklist.mold"></span></label><br />
        <label><input type="checkbox" name="pests" /> <span data-i18n="checklist.pests"></span></label><br />
        <label><input type="checkbox" name="leaks" /> <span data-i18n="checklist.leaks"></span></label><br />
        <label><input type="checkbox" name="lead" /> <span data-i18n="checklist.lead"></span></label><br />
        <label><input type="checkbox" name="noHVAC" /> <span data-i18n="checklist.noHVAC"></span></label><br />
        <label><input type="checkbox" name="noVent" /> <span data-i18n="checklist.noVent"></span></label><br />
        <label><input type="checkbox" name="tripHazards" /> <span data-i18n="checklist.tripHazards"></span></label><br />
        <label><input type="checkbox" name="asthmaTriggers" /> <span data-i18n="checklist.asthmaTriggers"></span></label><br />
      </form>
    </section>

    <section>
      <h2>🧍 <span data-i18n="sdoh.title">Resident SDOH Questionnaire</span></h2>
      <form id="sdohForm">
        <label data-i18n="sdoh.housingStable"></label><br />
        <select name="housingStable">
          <option value="">Select</option>
          <option value="yes">Yes</option>
          <option value="no">No</option>
        </select><br />

        <label data-i18n="sdoh.utilityShutoff"></label><br />
        <select name="utilityShutoff">
          <option value="">Select</option>
          <option value="yes">Yes</option>
          <option value="no">No</option>
        </select><br />

        <label data-i18n="sdoh.foodInsecurity"></label><br />
        <select name="foodInsecurity">
          <option value="">Select</option>
          <option value="yes">Yes</option>
          <option value="no">No</option>
        </select><br />

        <label data-i18n="sdoh.languagePref"></label><br />
        <input type="text" name="languagePref" />
      </form>
    </section>

    <section>
      <h2>📝 <span data-i18n="consent.title">Consent & Signature</span></h2>
      <label>
        <input type="checkbox" id="consentCheckbox" />
        <span data-i18n="consent.text"></span>
      </label><br /><br />

      <label data-i18n="consent.name"></label><br />
      <input type="text" id="residentName" /><br />

      <label data-i18n="consent.signature"></label><br />
      <input type="text" id="residentSignature" /><br />
    </section>

    <section>
      <h2>📍 <span data-i18n="map.header"></span></h2>
      <div id="map" style="height: 300px; margin-bottom: 1rem;"></div>

      <!-- ✅ Mock warning inserted here -->
      <p id="mockWarning" style="display:none; color:orange; font-weight:bold;">
        ⚠️ EJScreen data is currently mocked. Replace with real API before production use.
      </p>
    </section>

    <section>
      <h2 data-i18n="ejscreen.title">🌍 Environmental Context (EJScreen)</h2>

      <button onclick="getLocation()">📍 Use My Location</button>
      <p><strong>Address:</strong> <span id="userAddress">N/A</span></p>

      <div id="ejscreenData">
        <p><strong>Asthma Risk:</strong> <span id="asthmaRisk">--</span></p>
        <p><strong>Lead Exposure Risk:</strong> <span id="leadRisk">--</span></p>
        <p><strong>Air Quality Index (PM2.5):</strong> <span id="pm25">--</span></p>
      </div>
    </section>

    <button onclick="generateFHIR()" data-i18n="buttons.generate"></button>

    <h3 data-i18n="output.header">FHIR JSON Output:</h3>
    <button onclick="downloadJSON()" data-i18n="buttons.download_json"></button>
    <button onclick="downloadPDF()" data-i18n="buttons.download_pdf"></button>
    <pre id="output"></pre>
  </main>

  <script src="app.js"></script>
</body>
</html>
